<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ß–µ–∫-–ª–∏—Å—Ç –ø—Ä–∏—ë–º–∫–∏ –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–µ–π</title>
    <style>
        * {
            box-sizing: border-box;
        }
        body {
            font-family: Arial, sans-serif;
            margin: 10px;
            line-height: 1.5;
            font-size: 14px;
        }
        .controls {
            margin: 10px 0;
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }
        button, input, select {
            padding: 8px 10px;
            font-size: 14px;
            border: 1px solid #ccc;
            border-radius: 4px;
        }
        button {
            background-color: #f0f0f0;
            min-width: 120px;
        }
        #objectName {
            flex: 1;
            min-width: 150px;
        }
        #savedLists {
            flex: 1;
            min-width: 180px;
        }
        .checklist-item {
            border: 1px solid #ddd;
            border-radius: 5px;
            margin-bottom: 15px;
            overflow: hidden;
        }
        .item-header {
            background-color: #f5f5f5;
            padding: 8px;
            font-weight: bold;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .item-number {
            background: #333;
            color: white;
            padding: 3px 8px;
            border-radius: 10px;
            font-size: 12px;
        }
        .item-content {
            padding: 10px;
        }
        .form-group {
            margin-bottom: 10px;
        }
        .form-group label {
            display: block;
            margin-bottom: 3px;
            font-size: 12px;
            color: #555;
        }
        select, input[type="text"], input[type="number"], textarea {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
        }
        textarea {
            min-height: 60px;
            resize: vertical;
        }
        .small-input {
            width: 60px;
        }
        .defect-list {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
            margin: 5px 0;
        }
        .defect-tag {
            background: #ffecec;
            padding: 3px 8px;
            border-radius: 3px;
            font-size: 12px;
            display: inline-flex;
            align-items: center;
        }
        .defect-tag::after {
            content: "√ó";
            margin-left: 5px;
            cursor: pointer;
        }
        .material-row {
            display: flex;
            gap: 8px;
            margin-bottom: 5px;
        }
        .material-row input {
            flex: 1;
        }
        .toggle-section {
            background: #f0f0f0;
            padding: 8px;
            margin: 5px 0;
            border-radius: 4px;
            font-weight: bold;
            cursor: pointer;
        }
        .collapsible {
            display: none;
        }
        .collapsible.active {
            display: block;
        }
        @media (min-width: 768px) {
            body {
                margin: 20px;
                font-size: 16px;
            }
            .checklist-item {
                max-width: 800px;
                margin: 0 auto 20px;
            }
        }
    </style>
</head>
<body>
    <h1>–ß–µ–∫-–ª–∏—Å—Ç –ø—Ä–∏—ë–º–∫–∏ –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–µ–π</h1>
    
    <div class="controls">
        <input type="text" id="objectName" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞">
        <button onclick="addItem()">+ –î–æ–±–∞–≤–∏—Ç—å</button>
        <button onclick="saveChecklist()">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
        <button onclick="loadChecklist()">üìÇ –ó–∞–≥—Ä—É–∑–∏—Ç—å</button>
        <select id="savedLists" onchange="loadSelected()">
            <option value="">-- –í—ã–±–µ—Ä–∏—Ç–µ --</option>
        </select>
    </div>

    <div id="checklistContainer">
        <!-- –≠–ª–µ–º–µ–Ω—Ç—ã –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è –∑–¥–µ—Å—å -->
    </div>

    <script>
        // –î–∞–Ω–Ω—ã–µ –¥–ª—è –≤—ã–ø–∞–¥–∞—é—â–∏—Ö —Å–ø–∏—Å–∫–æ–≤
        const ROOM_TYPES = ["–°–ø–∞–ª—å–Ω—è", "–ì–æ—Å—Ç–∏–Ω–∞—è", "–ö—É—Ö–Ω—è", "–í–∞–Ω–Ω–∞—è", "–ö–æ—Ä–∏–¥–æ—Ä", "–û—Ñ–∏—Å"];
        const PLANE_TYPES = ["–°—Ç–µ–Ω–∞", "–ü–æ—Ç–æ–ª–æ–∫", "–ü–æ–ª", "–û—Ç–∫–æ—Å", "–î–≤–µ—Ä—å", "–ö–æ–ª–æ–Ω–Ω–∞", "–ê—Ä–∫–∞"];
        const BASE_MATERIALS = ["–ì–ö–õ", "–ì–í–õ", "–§–∞–Ω–µ—Ä–∞", "–û–°–ë", "–¶–µ–º–µ–Ω—Ç–Ω–∞—è —Å—Ç—è–∂–∫–∞", "–ö–∏—Ä–ø–∏—á", "–ë–µ—Ç–æ–Ω"];
        const DECORATIVE_TYPES = [
            "–ú–∏–∫—Ä–æ—Ü–µ–º–µ–Ω—Ç", "–ò–º–æ–ª–∞", "–ó–∞–º—à–∞", "–®–µ–ª–∫", 
            "–°—Ç—Ä—É–∫—Ç—É—Ä–∞—Ç–æ", "–ü–æ–∫—Ä–∞—Å–∫–∞", "2-—Å–ª–æ–π–∫–∞ –∏–∑–≤–µ—Å—Ç—å", 
            "2-—Å–ª–æ–π–∫–∞ –∞–∫—Ä–∏–ª", "–ö–≤–∞—Ä—Ü–º–∞—Ç", "–¢—Ä–∞–≤–µ—Ä—Ç–∏–Ω", "–°–∫–∞–ª–∞"
        ];
        const DEFECTS = ["–¶–∞—Ä–∞–ø–∏–Ω—ã", "–°–∫–æ–ª—ã", "–†—ã—Ö–ª–æ—Å—Ç—å", "–ù–∞–ø–ª—ã–≤—ã", "–ù–µ–æ—à–∫—É—Ä–µ–Ω–æ", "–û—Ç—Å–ª–æ–µ–Ω–∏—è", "–ü—è—Ç–Ω–∞"];

        let itemCount = 0;

        // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞
        function addItem(itemData = null) {
            itemCount++;
            const container = document.getElementById('checklistContainer');
            
            const item = document.createElement('div');
            item.className = 'checklist-item';
            item.dataset.id = itemCount;
            
            item.innerHTML = `
                <div class="item-header">
                    <span>–ü–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç—å #${itemCount}</span>
                    <span class="item-number">${itemCount}</span>
                </div>
                <div class="item-content">
                    <div class="form-group">
                        <label>–ü–æ–º–µ—â–µ–Ω–∏–µ</label>
                        <select class="room-type">
                            <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–º–µ—â–µ–Ω–∏–µ</option>
                            ${ROOM_TYPES.map(t => `
                                <option value="${t}" ${itemData?.roomType === t ? 'selected' : ''}>${t}</option>
                            `).join('')}
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label>–¢–∏–ø –ø–ª–æ—Å–∫–æ—Å—Ç–∏</label>
                        <div style="display:flex;gap:8px">
                            <select class="plane-type" style="flex:1">
                                <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø</option>
                                ${PLANE_TYPES.map(t => `
                                    <option value="${t}" ${itemData?.planeType === t ? 'selected' : ''}>${t}</option>
                                `).join('')}
                            </select>
                            <input type="number" class="small-input" min="1" value="${itemData?.planeCount || 1}" placeholder="–ö–æ–ª-–≤–æ">
                        </div>
                    </div>
                    
                    <div class="toggle-section" onclick="toggleSection(this, 'materials')">–ú–∞—Ç–µ—Ä–∏–∞–ª—ã –æ—Å–Ω–æ–≤–∞–Ω–∏—è ‚ñº</div>
                    <div id="materials-${itemCount}" class="collapsible">
                        <div class="form-group">
                            <label>–û—Å–Ω–æ–≤–Ω–æ–π –º–∞—Ç–µ—Ä–∏–∞–ª</label>
                            <div class="material-row">
                                <select class="base-material">
                                    <option value="">–¢–∏–ø –º–∞—Ç–µ—Ä–∏–∞–ª–∞</option>
                                    ${BASE_MATERIALS.map(m => `
                                        <option value="${m}" ${itemData?.baseMaterial === m ? 'selected' : ''}>${m}</option>
                                    `).join('')}
                                </select>
                                <input type="text" class="base-brand" placeholder="–ë—Ä–µ–Ω–¥" value="${itemData?.baseBrand || ''}">
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label>–ì–∏–¥—Ä–æ–∏–∑–æ–ª—è—Ü–∏—è</label>
                            <div class="material-row">
                                <input type="text" class="waterproofing-type" placeholder="–¢–∏–ø" value="${itemData?.waterproofingType || ''}">
                                <input type="text" class="waterproofing-brand" placeholder="–ë—Ä–µ–Ω–¥" value="${itemData?.waterproofingBrand || ''}">
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label>–®–ø–∞–∫–ª—ë–≤–∫–∞</label>
                            <div class="material-row">
                                <input type="text" class="putty-type" placeholder="–¢–∏–ø" value="${itemData?.puttyType || ''}">
                                <input type="text" class="putty-brand" placeholder="–ë—Ä–µ–Ω–¥" value="${itemData?.puttyBrand || ''}">
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label>–ì—Ä—É–Ω—Ç–æ–≤–∫–∞</label>
                            <div class="material-row">
                                <input type="text" class="primer-type" placeholder="–¢–∏–ø" value="${itemData?.primerType || ''}">
                                <input type="text" class="primer-brand" placeholder="–ë—Ä–µ–Ω–¥" value="${itemData?.primerBrand || ''}">
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label>–î–æ–ø. –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</label>
                            <textarea class="materials-notes">${itemData?.materialsNotes || ''}</textarea>
                        </div>
                    </div>
                    
                    <div class="toggle-section" onclick="toggleSection(this, 'decor')">–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –æ—Ç–¥–µ–ª–∫–∏ ‚ñº</div>
                    <div id="decor-${itemCount}" class="collapsible">
                        <div class="form-group">
                            <label>–¢–∏–ø –ø–æ–∫—Ä—ã—Ç–∏—è</label>
                            <select class="decorative-type">
                                <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø</option>
                                ${DECORATIVE_TYPES.map(t => `
                                    <option value="${t}" ${itemData?.decorativeType === t ? 'selected' : ''}>${t}</option>
                                `).join('')}
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label>–°–≤–æ–π—Å—Ç–≤–∞ –∏ —Ç–æ–ª—â–∏–Ω–∞</label>
                            <textarea class="decorative-props">${itemData?.decorativeProps || ''}</textarea>
                        </div>
                    </div>
                    
                    <div class="toggle-section" onclick="toggleSection(this, 'defects')">–î–µ—Ñ–µ–∫—Ç—ã ‚ñº</div>
                    <div id="defects-${itemCount}" class="collapsible">
                        <div class="form-group">
                            <div class="defect-list" id="defects-list-${itemCount}"></div>
                            <select class="defect-selector" onchange="addDefect(${itemCount})">
                                <option value="">–î–æ–±–∞–≤–∏—Ç—å –¥–µ—Ñ–µ–∫—Ç</option>
                                ${DEFECTS.map(d => `<option value="${d}">${d}</option>`).join('')}
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label>–î–æ–ø. –¥–µ—Ñ–µ–∫—Ç—ã</label>
                            <textarea class="additional-defects">${itemData?.additionalDefects || ''}</textarea>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label>–ü—Ä–∏–º–µ—á–∞–Ω–∏—è</label>
                        <textarea class="notes">${itemData?.notes || ''}</textarea>
                    </div>
                    
                    <button onclick="removeItem(${itemCount})" style="background:#ffebee;color:#c62828">–£–¥–∞–ª–∏—Ç—å</button>
                </div>
            `;
            
            container.appendChild(item);
            
            // –î–æ–±–∞–≤–ª—è–µ–º —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–µ –¥–µ—Ñ–µ–∫—Ç—ã
            if (itemData?.defects) {
                itemData.defects.forEach(defect => {
                    addDefect(itemCount, defect);
                });
            }
            
            // –û—Ç–∫—Ä—ã–≤–∞–µ–º –ø–µ—Ä–≤—ã–π —Ä–∞–∑–¥–µ–ª
            document.getElementById(`materials-${itemCount}`).classList.add('active');
        }

        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Å–µ–∫—Ü–∏–π
        function toggleSection(button, section) {
            const itemId = button.closest('.checklist-item').dataset.id;
            const sectionEl = document.getElementById(`${section}-${itemId}`);
            sectionEl.classList.toggle('active');
            button.innerHTML = button.innerHTML.includes('‚ñº') ? 
                button.innerHTML.replace('‚ñº', '‚ñ≤') : 
                button.innerHTML.replace('‚ñ≤', '‚ñº');
        }

        // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –¥–µ—Ñ–µ–∫—Ç–∞
        function addDefect(itemId, defectText = null) {
            const container = document.getElementById(`defects-list-${itemId}`);
            const selector = container.nextElementSibling;
            
            const defect = defectText || selector.value;
            if (!defect) return;
            
            const tag = document.createElement('span');
            tag.className = 'defect-tag';
            tag.textContent = defect;
            tag.onclick = () => tag.remove();
            
            container.appendChild(tag);
            selector.value = '';
        }

        // –£–¥–∞–ª–µ–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–∞
        function removeItem(itemId) {
            const item = document.querySelector(`.checklist-item[data-id="${itemId}"]`);
            if (item && confirm('–£–¥–∞–ª–∏—Ç—å —ç—Ç—É –∑–∞–ø–∏—Å—å?')) {
                item.remove();
                renumberItems();
            }
        }

        // –ü–µ—Ä–µ–Ω—É–º–µ—Ä–∞—Ü–∏—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤
        function renumberItems() {
            const items = document.querySelectorAll('.checklist-item');
            itemCount = items.length;
            
            items.forEach((item, index) => {
                const num = index + 1;
                item.dataset.id = num;
                item.querySelector('.item-header span:first-child').textContent = `–ü–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç—å #${num}`;
                item.querySelector('.item-number').textContent = num;
            });
        }

        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —á–µ–∫-–ª–∏—Å—Ç–∞
        function saveChecklist() {
            const objectName = document.getElementById('objectName').value.trim();
            if (!objectName) return alert("–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞");
            
            const items = [];
            document.querySelectorAll('.checklist-item').forEach(itemEl => {
                const itemId = itemEl.dataset.id;
                
                items.push({
                    // –ü–æ–º–µ—â–µ–Ω–∏–µ –∏ –ø–ª–æ—Å–∫–æ—Å—Ç—å
                    roomType: itemEl.querySelector('.room-type').value,
                    planeType: itemEl.querySelector('.plane-type').value,
                    planeCount: itemEl.querySelector('.small-input').value,
                    
                    // –ú–∞—Ç–µ—Ä–∏–∞–ª—ã –æ—Å–Ω–æ–≤–∞–Ω–∏—è
                    baseMaterial: itemEl.querySelector('.base-material').value,
                    baseBrand: itemEl.querySelector('.base-brand').value,
                    waterproofingType: itemEl.querySelector('.waterproofing-type').value,
                    waterproofingBrand: itemEl.querySelector('.waterproofing-brand').value,
                    puttyType: itemEl.querySelector('.putty-type').value,
                    puttyBrand: itemEl.querySelector('.putty-brand').value,
                    primerType: itemEl.querySelector('.primer-type').value,
                    primerBrand: itemEl.querySelector('.primer-brand').value,
                    materialsNotes: itemEl.querySelector('.materials-notes').value,
                    
                    // –î–µ–∫–æ—Ä–∞—Ç–∏–≤–Ω–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ
                    decorativeType: itemEl.querySelector('.decorative-type').value,
                    decorativeProps: itemEl.querySelector('.decorative-props').value,
                    
                    // –î–µ—Ñ–µ–∫—Ç—ã
                    defects: Array.from(itemEl.querySelectorAll('.defect-tag')).map(tag => tag.textContent),
                    additionalDefects: itemEl.querySelector('.additional-defects').value,
                    
                    // –ü—Ä–∏–º–µ—á–∞–Ω–∏—è
                    notes: itemEl.querySelector('.notes').value
                });
            });
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ localStorage
            localStorage.setItem(`checklist_${objectName}`, JSON.stringify({
                name: objectName,
                items: items
            }));
            
            updateSavedLists();
            alert(`–ß–µ–∫-–ª–∏—Å—Ç "${objectName}" —Å–æ—Ö—Ä–∞–Ω—ë–Ω!`);
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ —á–µ–∫-–ª–∏—Å—Ç–∞
        function loadChecklist(objectName = null) {
            const name = objectName || document.getElementById('objectName').value.trim();
            if (!name) return alert("–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞");
            
            const savedData = localStorage.getItem(`checklist_${name}`);
            if (!savedData) return alert("–ß–µ–∫-–ª–∏—Å—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω");
            
            const data = JSON.parse(savedData);
            document.getElementById('objectName').value = data.name;
            document.getElementById('checklistContainer').innerHTML = '';
            itemCount = 0;
            
            data.items.forEach(item => {
                addItem(item);
            });
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã—Ö —á–µ–∫-–ª–∏—Å—Ç–æ–≤
        function updateSavedLists() {
            const select = document.getElementById('savedLists');
            select.innerHTML = '<option value="">-- –í—ã–±–µ—Ä–∏—Ç–µ --</option>';
            
            for (let i = 0; i < localStorage.length; i++) {
                const key = localStorage.key(i);
                if (key.startsWith('checklist_')) {
                    const option = document.createElement('option');
                    option.value = key.replace('checklist_', '');
                    option.textContent = option.value;
                    select.appendChild(option);
                }
            }
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —á–µ–∫-–ª–∏—Å—Ç–∞
        function loadSelected() {
            const selected = document.getElementById('savedLists').value;
            if (selected) loadChecklist(selected);
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        window.onload = function() {
            updateSavedLists();
            addItem(); // –î–æ–±–∞–≤–ª—è–µ–º –ø–µ—Ä–≤—ã–π –ø—É—Å—Ç–æ–π —ç–ª–µ–º–µ–Ω—Ç
        };

        // –ó–∞–∫—Ä—ã—Ç–∏–µ/–æ—Ç–∫—Ä—ã—Ç–∏–µ –ø–æ –¥–≤–æ–π–Ω–æ–º—É —Ç–∞–ø—É
        document.addEventListener('dblclick', function(e) {
            if (e.target.classList.contains('toggle-section')) {
                toggleSection(e.target, e.target.getAttribute('onclick').match(/toggleSection\(this, '(\w+)'/)[1]);
            }
        });
    </script>
</body>
</html>